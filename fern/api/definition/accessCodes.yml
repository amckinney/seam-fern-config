# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json
imports: 
  devices: devices.yml
  actionAttempts: actionAttempts.yml

service:
  auth: true
  base-path: /acccess_codes
  endpoints:
    create:
      docs: Create an Access Code for a Device by its ID
      method: POST
      path: /create
      request: 
        name: CreateAccessCode
        body: 
          properties:
            device_id:
              type: string
              docs: ID of the Device
            name:
              type: optional<string>
              docs: Name of the Access Code
            starts_at:
              type: optional<datetime>
              docs: Start Time of the Access Code
            ends_at:
              type: optional<datetime>
              docs: End Time of the Access Code
            code: 
              type: optional<string>
              docs: Pin code to be programmed.
            common_code_key: 
              type: optional<string>
              docs: any two access codes with the same `common_code_key` are guaranteed to have the same code
            sync:
              type: optional<boolean>
              docs: Set this to true to receive the `access_code` object in the `result`
      response: CreateAccessCodeResponse
  
    update:
      docs: Update an Access Code for a Device by its ID
      method: PUT 
      path: /update 
      request: 
        name: UpdateAccessCodeRequest
        body: 
          properties: 
            access_code_id:
              type: string
              docs: Access code id
            name:
              type: optional<string>
              docs: Access code name
            code: 
              type: optional<string>
              docs: Access code
            starts_at:
              type: optional<datetime>
              docs: Start Time of the Access Code
            ends_at:
              type: optional<datetime>
              docs: End Time of the Access Code
      response: UpdateAccessCodeResponse

    delete: 
      docs: Delete an Access Code
      method: DELETE
      path: /delete
      request:
        name: DeleteAccessCodeRequest
        query-parameters:
          access_code_id: 
            type: string
            docs: ID of the Access Code
      response: actionAttempts.ActionAttempt

types:
  AccessCodeId: uuid

  CreateAccessCodeResponse: 
    properties:
      action_attempt: actionAttempts.ActionAttempt
      access_code: AccessCode

  UpdateAccessCodeResponse: 
    properties:
      action_attempt: actionAttempts.ActionAttempt

  AccessCode: 
    properties:
      access_code_id: 
        type: AccessCodeId
        docs: ID of the Access Code
      device_id: 
        type: devices.DeviceId
        docs: ID of the Device
      type: string 
      code: 
        type: string
        docs: Access code of Device
      starts_at:
        type: optional<datetime>
        docs: Timestamp of when the Access Code begins (only relevant for time_bound codes)
      ends_at:
        type: optional<datetime>
        docs: Timestamp of when the Access Code ends (only relevant for time_bound codes)
      created_at: 
        type: datetime
        docs: Timestamp of when the Access Code was created
      name:   
        type: optional<string>
        docs: Name of Access Code
      status: optional<string>
      common_code_key: optional<string> 
      errors: list<AccessCodeError>
      warnings: list<AccessCodeWarning>
  
  AccessCodeStatus: 
    enum: 
      - value: unset
        docs: The time frame for an access code has not begun; the code is not set
      - value: setting
        docs: The code is being set
      - value: set
        docs: The code has been set
      - value: removing
        docs: The code is being removed
  
  AccessCodeError: 
    properties: 
      message: string
      created_at: datetime
  
  AccessCodeWarning: 
    properties: 
      message: string
      created_at: datetime
